<input
  #fileInput
  class="tedi-file-dropzone__input"
  type="file"
  [disabled]="disabled()"
  [multiple]="multiple()"
  [id]="inputId()"
  [attr.webkitdirectory]="uploadFolder() ? '' : null"
  [accept]="accept()"
  (change)="selectionChange($event)"
/>

<button [className]="classes()" (click)="onContainerClick()">
  <div class="tedi-file-dropzone__label-wrapper">
    <tedi-icon
      [name]="isDragActive() ? 'file_upload' : 'attach_file'"
      [color]="disabled() ? 'tertiary' : 'secondary'"
    />
    <label tedi-label class="tedi-file-dropzone__label">{{
      (isDragActive() ? "file-upload.drag-and-drop" : label()) | tediTranslate
    }}</label>
  </div>
</button>

<ng-content select="[helper-text]">
  @if (helperText(); as message) {
    <tedi-feedback-text
      [text]="message.text"
      [type]="message.type || 'hint'"
      [position]="message.position || 'left'"
    />
  }
</ng-content>

@for (file of files(); track file.name) {
  <div class="tedi-file-dropzone__file-list" [tediVerticalSpacing]="0.5">
    <tedi-card
      [className]="fileClasses(file)"
      padding="none"
      [background]="
        file.fileStatus && file.fileStatus == 'invalid'
          ? 'danger-primary'
          : 'tertiary'
      "
    >
      <tedi-card-content class="tedi-file-dropzone__card" padding="xs">
        <div class="tedi-file-dropzone__file-name">
          {{ file.label ?? file.name }}

          @if (file && validateIndividually() && file.helper; as helper) {
            <tedi-tooltip [className]="tooltipClasses(file)">
              <tedi-tooltip-trigger>
                <button tedi-info-button [disabled]="file.disabled"></button>
              </tedi-tooltip-trigger>

              <tedi-tooltip-content [position]="helper?.position || 'top'">
                {{ helper.text }}
              </tedi-tooltip-content>
            </tedi-tooltip>
          }
        </div>
        <button
          tedi-closing-button
          [title]="'clear' | tediTranslate"
          [iconSize]="18"
          (click)="removeFile(file)"
          size="small"
        ></button>
      </tedi-card-content>
    </tedi-card>
  </div>
}

<ng-content select="[error-text]">
  @if (this.uploadError(); as message) {
    <tedi-feedback-text [text]="message" type="error" position="left" />
  }
</ng-content>
